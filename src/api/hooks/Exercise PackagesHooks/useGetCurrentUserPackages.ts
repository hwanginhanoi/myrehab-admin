/**
 * Generated by Kubb (https://kubb.dev/).
 * Do not edit manually.
 */

import fetch from "@/lib/api-client";
import type {
  GetCurrentUserPackagesQueryResponse,
  GetCurrentUserPackagesQueryParams,
} from "../../types/exercisePackagesController/GetCurrentUserPackages.ts";
import type { RequestConfig, ResponseErrorConfig } from "@/lib/api-client";
import type {
  QueryKey,
  QueryClient,
  QueryObserverOptions,
  UseQueryResult,
} from "@tanstack/react-query";
import { queryOptions, useQuery } from "@tanstack/react-query";

export const getCurrentUserPackagesQueryKey = (
  params: GetCurrentUserPackagesQueryParams,
) =>
  [{ url: "/api/exercise-packages/me" }, ...(params ? [params] : [])] as const;

export type GetCurrentUserPackagesQueryKey = ReturnType<
  typeof getCurrentUserPackagesQueryKey
>;

/**
 * @description Retrieve all exercise packages that the current user has active subscriptions for, including subscription details (expiry date, subscription type, purchase date). Also includes current pricing information (monthlyPrice and yearlyPrice in VND) for renewal reference.
 * @summary Get current user's purchased exercise packages
 * {@link /api/exercise-packages/me}
 */
export async function getCurrentUserPackages(
  params: GetCurrentUserPackagesQueryParams,
  config: Partial<RequestConfig> & { client?: typeof fetch } = {},
) {
  const { client: request = fetch, ...requestConfig } = config;

  const res = await request<
    GetCurrentUserPackagesQueryResponse,
    ResponseErrorConfig<Error>,
    unknown
  >({
    method: "GET",
    url: `/api/exercise-packages/me`,
    params,
    ...requestConfig,
  });
  return res.data;
}

export function getCurrentUserPackagesQueryOptions(
  params: GetCurrentUserPackagesQueryParams,
  config: Partial<RequestConfig> & { client?: typeof fetch } = {},
) {
  const queryKey = getCurrentUserPackagesQueryKey(params);
  return queryOptions<
    GetCurrentUserPackagesQueryResponse,
    ResponseErrorConfig<Error>,
    GetCurrentUserPackagesQueryResponse,
    typeof queryKey
  >({
    enabled: !!params,
    queryKey,
    queryFn: async ({ signal }) => {
      config.signal = signal;
      return getCurrentUserPackages(params, config);
    },
  });
}

/**
 * @description Retrieve all exercise packages that the current user has active subscriptions for, including subscription details (expiry date, subscription type, purchase date). Also includes current pricing information (monthlyPrice and yearlyPrice in VND) for renewal reference.
 * @summary Get current user's purchased exercise packages
 * {@link /api/exercise-packages/me}
 */
export function useGetCurrentUserPackages<
  TData = GetCurrentUserPackagesQueryResponse,
  TQueryData = GetCurrentUserPackagesQueryResponse,
  TQueryKey extends QueryKey = GetCurrentUserPackagesQueryKey,
>(
  params: GetCurrentUserPackagesQueryParams,
  options: {
    query?: Partial<
      QueryObserverOptions<
        GetCurrentUserPackagesQueryResponse,
        ResponseErrorConfig<Error>,
        TData,
        TQueryData,
        TQueryKey
      >
    > & { client?: QueryClient };
    client?: Partial<RequestConfig> & { client?: typeof fetch };
  } = {},
) {
  const { query: queryConfig = {}, client: config = {} } = options ?? {};
  const { client: queryClient, ...queryOptions } = queryConfig;
  const queryKey =
    queryOptions?.queryKey ?? getCurrentUserPackagesQueryKey(params);

  const query = useQuery(
    {
      ...getCurrentUserPackagesQueryOptions(params, config),
      queryKey,
      ...queryOptions,
    } as unknown as QueryObserverOptions,
    queryClient,
  ) as UseQueryResult<TData, ResponseErrorConfig<Error>> & {
    queryKey: TQueryKey;
  };

  query.queryKey = queryKey as TQueryKey;

  return query;
}
